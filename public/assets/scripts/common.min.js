var Tinycar;!function(t){var e;!function(e){function i(t,e){return this.eventList.hasOwnProperty(t)?(e.preventDefault(),this.eventList[t].forEach(function(t){t instanceof Function&&t(e)}),!0):void 0}function n(t,e){this.eventList.hasOwnProperty(t)||(this.eventList[t]=[]);var i=this.eventList[t].length;return this.eventList[t].push(e),i}function o(){return this.initListeners(),this.buildRoot(),this.Page=new t.Main.Page,this.htmlRoot.append(this.Page.build()),this.Side=new t.Main.Sidebar,this.htmlRoot.append(this.Side.build()),this.Mask=new t.Main.Mask,this.htmlRoot.append(this.Mask.build()),this.Toast=new t.Main.Toast,this.htmlRoot.append(this.Toast.build()),this.openApplication(t.Url.getParam("app")),this.htmlRoot}function a(e){t.Config.load(e.config),t.Url.load(e.params),t.Api.setApiUrl(t.Config.get("API_PATH")),t.Locale.loadCalendar(e.calendar),t.Locale.loadText(e.text),t.User.load(e.user)}function s(){this.htmlRoot=$("<div>").attr("id","tinycar-root")}function r(t,e){this.eventList[t][e]=null}function l(){var t=this;$(window).keydown(function(e){e.ctrlKey&&!e.shiftKey&&83===e.keyCode&&t.callEvent("ctrl+s",e)}),$(window).resize(function(e){t.callEvent("resize",e)})}function p(){return t.Config.get("UI_LOGIN")===!0&&t.User.hasAuthenticated()===!1}function c(e){var i=t.Url.getParam("view");this.isLoginRequired()&&(e=t.Config.get("APP_LOGIN"),i="default");var n=new t.Ui.Application(e);this.htmlRoot.append(n.build()),n.loadView(i)}e.appList={},e.eventList={},e.callEvent=i,e.addEvent=n,e.build=o,e.load=a,e.buildRoot=s,e.clearEvent=r,e.initListeners=l,e.isLoginRequired=p,e.openApplication=c}(e=t.System||(t.System={}))}(Tinycar||(Tinycar={}));var Tinycar;!function(t){var e;!function(e){function i(e){var i={api_id:++this.requestId,api_service:e.service};e.hasOwnProperty("params")&&jQuery.extend(i,e.params),$.ajax({type:"POST",url:this.apiUrl,dataType:"json",data:JSON.stringify(i),contentType:"application/json; charset=utf-8",success:function(i){i.hasOwnProperty("result")?e.success(i.result):i.hasOwnProperty("error")&&(t.System.Toast.setMessage({type:"failure",vars:i.error.message,text:t.Locale.getText("toast_"+i.error.code)}),t.System.Toast.show())},error:function(t){console.log(t)}})}function n(t){this.apiUrl=t}e.requestId=0,e.call=i,e.setApiUrl=n}(e=t.Api||(t.Api={}))}(Tinycar||(Tinycar={}));var Tinycar;!function(t){var e;!function(t){function e(t){this.configList=t}function i(t){return this.configList.hasOwnProperty(t)?this.configList[t]:null}function n(t,e){this.configList[t]=e}t.configList={},t.load=e,t.get=i,t.set=n}(e=t.Config||(t.Config={}))}(Tinycar||(Tinycar={}));var Tinycar;!function(t){var e;!function(e){function i(e,i){if("number"!=typeof e||0===e)return null;var n=new Date(0);n.setUTCSeconds(e);for(var o={d:function(){var t=o.j();return""+(10>t?"0"+t:t)},G:function(){return n.getHours()},H:function(){var t=o.G();return""+(10>t?"0"+t:t)},i:function(){var t=n.getMinutes();return""+(10>t?"0"+t:t)},j:function(){return n.getDate()},l:function(){return t.Locale.getText("calendar_day_"+n.getDay())},m:function(){var t=o.n();return""+(10>t?"0"+t:t)},n:function(){return n.getMonth()+1},Y:function(){return n.getFullYear()}},a="",s=0,r=i.length;r>s;++s){var l=i.substring(s,s+1);a+=o.hasOwnProperty(l)?o[l]():l}return a}function n(t){if("string"!=typeof t||0===t.length)return null;for(var e,i,n=[{pattern:/([\d]{1,2})\.([\d]{1,2})\.([\d]{4})[\s]{0,}([\d]{1,2})\:([\d]{1,2})/,matches:[3,2,1,4,5,null]},{pattern:/([\d]{1,2})\.([\d]{1,2})\.([\d]{4})/,matches:[3,2,1,null,null,null]},{pattern:/([\d]{4})\-([\d]{1,2})\-([\d]{1,2})/,matches:[1,2,3,null,null,null]}],o=0,a=n.length;a>o;++o)if(e=t.match(n[o].pattern),null!==e){i=n[o].matches;var s=new Date;return s.setFullYear(parseInt(e[i[0]])),s.setMonth(parseInt(e[i[1]])-1),s.setDate(parseInt(e[i[2]])),s.setHours(null!==i[3]?parseInt(e[i[3]]):0),s.setMinutes(null!==i[4]?parseInt(e[i[4]]):0),s.setSeconds(null!==i[5]?parseInt(e[i[5]]):0),Math.round((s.getTime()+s.getTimezoneOffset())/1e3)}return null}e.toDate=i,e.toTime=n}(e=t.Format||(t.Format={}))}(Tinycar||(Tinycar={}));var Tinycar;!function(t){var e;!function(e){function i(t){return this.calendarList.hasOwnProperty(t)?this.calendarList[t]:t}function n(t,e){var i=this.textList.hasOwnProperty(t)?this.textList[t]:t;if("undefined"!=typeof e)for(var n in e)i=i.split("$"+n).join(e[n]);return i}function o(t){for(var e in t)this.calendarList[e]=t[e]}function a(t){for(var e in t)this.textList[e]=t[e]}function s(e,i){var n=this.getCalendar("format_"+i);return"string"!=typeof n?null:t.Format.toDate(e,n)}e.calendarList={},e.textList={},e.getCalendar=i,e.getText=n,e.loadCalendar=o,e.loadText=a,e.toDate=s}(e=t.Locale||(t.Locale={}))}(Tinycar||(Tinycar={}));var Tinycar;!function(t){var e;!function(t){function e(t){sessionStorage.removeItem(t)}function i(t){var e=sessionStorage.getItem(t);return"string"!=typeof e?{}:(e=JSON.parse(e),e instanceof Object?e:{})}function n(t){return null!==sessionStorage.getItem(t)}function o(t,e){sessionStorage.setItem(t,JSON.stringify(e))}t.clear=e,t.get=i,t.has=n,t.set=o}(e=t.Session||(t.Session={}))}(Tinycar||(Tinycar={}));var Tinycar;!function(t){var e;!function(e){function i(e){var i={app:this.getParam("app"),view:this.getParam("view")};e.hasOwnProperty("app")&&(i.app=e.app),e.hasOwnProperty("view")&&(i.view=e.view),e.hasOwnProperty("id")&&(i.id=e.id),"default"===i.view&&delete i.view;var n=[];for(var o in i)n.push(o+":"+i[o]);return"?"+t.Config.get("PATH_PARAM")+"=/"+n.join("/")+"/"}function n(t){return this.paramList.hasOwnProperty(t)?this.paramList[t]:null}function o(){return this.paramList}function a(){var t=this,e="uid",i=["app","view","id"];return i.forEach(function(i){t.paramList.hasOwnProperty(i)&&(e+="-"+t.paramList[i])}),e}function s(t){return this.paramList.hasOwnProperty(t)}function r(e){for(var i in e)this.paramList[i]=e[i];this.paramList.hasOwnProperty("app")||(this.paramList.app=t.Config.get("APP_HOME")),this.paramList.hasOwnProperty("view")||(this.paramList.view="default")}function l(e){t.System.Page.setState("unloading"),location.href=e}function p(t,e){this.paramList[t]=e}function c(t,e){var i=this.getAsPath(t);if("object"==typeof e)for(var n in e)for(var o in e[n])i=i.split("$"+n+"."+o).join(e[n][o]);this.updateUrl(i)}function u(e){t.System.Page.setState("unloading"),location.replace(e)}e.paramList={},e.getAsPath=i,e.getParam=n,e.getParams=o,e.getUid=a,e.hasParam=s,e.load=r,e.openUrl=l,e.setParam=p,e.updatePath=c,e.updateUrl=u}(e=t.Url||(t.Url={}))}(Tinycar||(Tinycar={}));var Tinycar;!function(t){var e;!function(t){function e(t){return this.dataList.hasOwnProperty(t)?this.dataList[t]:null}function i(){return this.get("is_empty")===!1}function n(t){this.dataList=t}t.dataList={},t.get=e,t.hasAuthenticated=i,t.load=n}(e=t.User||(t.User={}))}(Tinycar||(Tinycar={}));var Tinycar;!function(t){var e;!function(t){var e=function(){function t(t){this.dataList=[],this.dataList=t}return t.prototype.addAll=function(t){for(var e in t)this.dataList[e]=t[e]},t.prototype.get=function(t){return this.dataList.hasOwnProperty(t)?this.dataList[t]:null},t.prototype.getAll=function(){return this.dataList},t.prototype.getIndex=function(t,e){return this.isArray(t)?this.dataList[t].length<e?null:this.dataList[t][e]:null},t.prototype.getNumber=function(t){return this.isNumber(t)?this.dataList[t]:0},t.prototype.getList=function(t){return this.isArray(t)?this.dataList[t]:[]},t.prototype.getString=function(t){var e=this.get(t);return"string"==typeof e?e:""},t.prototype.getObject=function(t){return this.isObject(t)?this.dataList[t]:{}},t.prototype.has=function(t){return this.dataList.hasOwnProperty(t)},t.prototype.load=function(t){this.dataList=t},t.prototype.hasNumber=function(t){return this.isNumber(t)&&this.dataList[t]>0},t.prototype.hasString=function(t){return this.isString(t)&&this.dataList[t].length>0},t.prototype.isArray=function(t){return this.dataList.hasOwnProperty(t)&&this.dataList[t]instanceof Array},t.prototype.isNumber=function(t){return this.dataList.hasOwnProperty(t)&&"number"==typeof this.dataList[t]},t.prototype.isObject=function(t){return this.dataList.hasOwnProperty(t)&&this.dataList[t]instanceof Object&&!(this.dataList[t]instanceof Array)},t.prototype.isString=function(t){return this.dataList.hasOwnProperty(t)&&"string"==typeof this.dataList[t]},t.prototype.set=function(t,e){this.dataList[t]=e},t}();t.DataItem=e}(e=t.Model||(t.Model={}))}(Tinycar||(Tinycar={}));var Tinycar;!function(t){var e;!function(t){var e=function(){function t(t,e,i){this.handlerList={},this.isCmpVisible=!1,this.App=t,this.View=e,this.Model=i}return t.prototype.action=function(t,e,i){this.View.onComponent(this.Model.get("id"),t,e,i)},t.prototype.build=function(){return this.buildRoot(),this.buildContent(),this.htmlRoot},t.prototype.buildContent=function(){},t.prototype.buildRoot=function(){var t=this.Model.get("type_name").toLowerCase();this.htmlRoot=$("<div>").addClass(this.getRootStyles().join(" ")).addClass("tinycar-ui-component-"+t)},t.prototype.callHandler=function(t,e){this.handlerList.hasOwnProperty(t)&&this.handlerList[t](e)},t.prototype.getId=function(){return this.Model.get("id")},t.prototype.getRootStyles=function(){return["tinycar-main-component"]},t.prototype.getTabName=function(){return this.Model.get("tab_name")},t.prototype.isVisible=function(){return this.isCmpVisible},t.prototype.refresh=function(){},t.prototype.setAsVisible=function(t){t===!0?(this.isCmpVisible=!0,this.htmlRoot.addClass("is-visible")):(this.isCmpVisible=!1,this.htmlRoot.removeClass("is-visible"))},t.prototype.setHandler=function(t,e){this.handlerList[t]=e},t.prototype.start=function(){},t}();t.Component=e}(e=t.Main||(t.Main={}))}(Tinycar||(Tinycar={}));var __extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},Tinycar;!function(t){var e;!function(e){var i=function(e){function i(){e.apply(this,arguments)}return __extends(i,e),i.prototype.build=function(){return this.buildRoot(),this.Model.hasString("type_label")?this.buildTypeLabel():this.buildEmptyLabel(),this.buildContent(),this.Model.hasString("type_instructions")&&this.buildTypeInstructions(),this.htmlRoot},i.prototype.buildContent=function(){this.htmlContent=$("<div>").attr("class","type-content").appendTo(this.htmlRoot)},i.prototype.buildEmptyLabel=function(){$("<div>").attr("class","type-label-empty").appendTo(this.htmlRoot)},i.prototype.buildTypeInstructions=function(){$("<div>").attr("class","type-instructions").text(this.Model.get("type_instructions")).appendTo(this.htmlContent)},i.prototype.buildTypeLabel=function(){var e=$("<div>").attr("class","type-label").appendTo(this.htmlRoot),i=$("<label>").attr("class","label").attr("for",this.getFieldId()).text(this.Model.get("type_label")).appendTo(e);if(this.Model.get("data_required")===!0&&(i.attr("title",t.Locale.getText("info_required_field")),$("<span>").attr("class","required theme-base").appendTo(i)),this.Model.hasString("type_help")){var n=new t.Ui.Main.Help(this.Model.get("type_help"));e.append(n.build())}},i.prototype.focus=function(){},i.prototype.getRootStyles=function(){var t=e.prototype.getRootStyles.call(this);return t.push("tinycar-main-field"),this.isTypeEnabled()===!0&&t.push("is-enabled"),t},i.prototype.getDataName=function(){return this.Model.get("data_name")},i.prototype.getDataValue=function(){return this.Model.get("data_value")},i.prototype.getFieldId=function(t){return void 0===t&&(t=""),"field-"+this.Model.get("id")+"-"+t},i.prototype.isTypeEnabled=function(){return this.Model.get("type_enabled")!==!1},i.prototype.setDataValue=function(t){this.Model.set("data_value",t)},i}(t.Main.Component);e.Field=i}(e=t.Main||(t.Main={}))}(Tinycar||(Tinycar={}));var Tinycar;!function(t){var e;!function(t){var e=function(){function t(){}return t.prototype.build=function(){return this.buildRoot(),this.htmlRoot},t.prototype.buildRoot=function(){this.htmlRoot=$("<div>").attr("id","tinycar-main-mask")},t.prototype.hide=function(){this.htmlRoot.addClass("is-hidden")},t.prototype.show=function(){this.htmlRoot.removeClass("is-hidden").addClass("is-visible")},t}();t.Mask=e}(e=t.Main||(t.Main={}))}(Tinycar||(Tinycar={}));var Tinycar;!function(t){var e;!function(e){var i=function(){function e(){this.loadedVendors=["app"],this.customStyles="\n		\n			a:hover {\n				color: %base%;\n			}\n		\n			input[type=text]:focus,\n			select:focus,\n			textarea:focus { \n				border-color: %base%;\n			}\n			\n			div.tinycar-ui-component-checkbox:not(old) label:hover > span.mark,\n			div.tinycar-ui-component-radiolist:not(old) label:hover > span.mark {\n				border-color: %base% !important; \n			}\n			\n			div.tinycar-ui-component-checkbox:not(old) input:checked + label > span.mark,\n			div.tinycar-ui-component-radiolist:not(old) input:checked + label > span.mark {\n				\n				border-color: %base% !important;\n				background-color: %base% !important;\n			\n			}\n			\n			.theme-background {\n				background-color: %base% !important;\n			}\n			\n			.theme-text {\n				color: %base%;\n			}\n			\n			.theme-base {\n				background-color: %base%;\n			}\n			\n			.theme-border {\n				border-color: %base% !important;\n			}\n			\n			a.theme-base-lite {\n\n				border-color: %base% !important;\n				background-color: %base% !important;\n				color: #ffffff;\n			\n			}\n			\n			a.theme-base-lite:focus,\n			a.theme-base-lite:hover {\n				\n				border-color: %dark% !important;\n				background-color: %dark% !important;\n				color: #ffffff;\n				text-decoration: none;\n			\n			}\n			\n			a.theme-base-lite:active {\n				\n				border-color: %lite% !important;\n				background-color: %lite% !important;\n				color: #ffffff;\n			\n			}\n			\n			div.tinycar-ui-component-datagrid.is-selectable a.is-selected span.check {\n				\n				border-color: %base% !important;\n				background-color: %base% !important;\n			\n			}\n			\n			div.tinycar-ui-component-datagrid.is-selectable a:hover span.check,\n			div.tinycar-ui-component-datagrid.is-selectable a:focus span.check {\n				border-color: %base% !important;\n			}\n			\n			div.ui-datepicker td:hover > a {\n\n				border-color: %base% !important;\n				background-color: #ffffff !important;\n			\n			}\n			\n			div.ui-datepicker td:active > a {\n				border-color: transparent !important;\n			}\n\n			div.ui-datepicker td.ui-datepicker-current-day > a {\n				\n				background-color: %base% !important;\n				color: #ffffff !important;\n			\n			}\n			\n		"}return e.prototype.build=function(){return this.buildStyles(),this.htmlRoot=$("body:first"),this.htmlRoot.addClass("is-prepared"),this.htmlStyles},e.prototype.buildStyles=function(){this.htmlStyles=$("<style>").attr("type","text/css")},e.prototype.loadVendor=function(e,i){if(this.loadedVendors.indexOf(e)>-1)return i(),!0;this.loadedVendors.push(e),require([e],function(){i()});var n=t.Config.get("VENDOR_STYLES");return n.hasOwnProperty(e)&&$("<link>").attr("type","text/css").attr("rel","stylesheet").attr("href",n[e]+".css").appendTo($("head:first")),!0},e.prototype.setLayoutName=function(t){this.htmlRoot.addClass("layout-"+t),"main"!==t&&this.htmlRoot.addClass("theme-background")},e.prototype.setState=function(t){var e=this;this.htmlRoot.addClass("is-"+t),"unloading"===t&&window.setTimeout(function(){e.htmlRoot.removeClass("is-unloading")},3e3)},e.prototype.setThemeColors=function(t){var e=this.customStyles;for(var i in t)e=e.split("%"+i+"%").join(t[i]);this.htmlStyles.html(e)},e.prototype.setTitle=function(t){document.title=t.join(" - ")},e}();e.Page=i}(e=t.Main||(t.Main={}))}(Tinycar||(Tinycar={}));var Tinycar;!function(t){var e;!function(e){var i=function(){function e(){this.sessionActions=[],this.systemActions=[],this.viewActions=[]}return e.prototype.build=function(){return this.buildRoot(),this.htmlRoot},e.prototype.addAction=function(e){e.isSaveAction()&&t.System.addEvent("ctrl+s",function(){e.execute()}),e.isViewAction()?this.viewActions.push(e):e.isSessionAction()?this.sessionActions.push(e):this.systemActions.push(e)},e.prototype.buildAppIcon=function(){var t=$("<div>").attr("class","app-icon").appendTo(this.htmlRoot);this.htmlIcon=$("<span>").appendTo(t)},e.prototype.buildRoot=function(){this.htmlRoot=$("<div>").attr("id","tinycar-main-sidebar").attr("class","theme-base")},e.prototype.buildSessionActions=function(){var t=$("<div>").attr("class","session-actions").appendTo(this.htmlRoot);this.sessionActions.forEach(function(e){t.append(e.build())})},e.prototype.buildSystemActions=function(){var t=$("<div>").attr("class","system-actions").appendTo(this.htmlRoot);this.systemActions.forEach(function(e){t.append(e.build())})},e.prototype.buildViewActions=function(){var t=$("<div>").attr("class","view-actions").appendTo(this.htmlRoot);this.viewActions.forEach(function(e){t.append(e.build())})},e.prototype.update=function(t){this.buildAppIcon(),this.systemActions.length>0&&this.buildSystemActions(),this.viewActions.length>0&&this.buildViewActions(),this.sessionActions.length>0&&this.buildSessionActions(),this.htmlRoot.show(),null!==t.Model.get("icon")&&this.htmlIcon.css("background-image","url("+t.Model.get("icon")+")")},e}();e.Sidebar=i}(e=t.Main||(t.Main={}))}(Tinycar||(Tinycar={}));var Tinycar;!function(t){var e;!function(e){var i=function(){function e(){this.isMouseOver=!1}return e.prototype.build=function(){return this.buildRoot(),this.buildMessage(),this.buildClose(),t.Session.has("toast-message")&&this.loadSession(),this.htmlRoot},e.prototype.buildMessage=function(){this.htmlMessage=$("<div>").attr("class","message").appendTo(this.htmlRoot)},e.prototype.buildClose=function(){var t=this,e=$("<a>").attr("class","close").appendTo(this.htmlRoot);$("<span>").attr("class","icon icon-small icon-close").appendTo(e),e.click(function(e){e.preventDefault(),t.hide()})},e.prototype.buildRoot=function(){var t=this;this.htmlRoot=$("<div>").attr("id","tinycar-main-toast"),this.htmlRoot.mouseenter(function(){t.isMouseOver=!0}),this.htmlRoot.mouseleave(function(){t.isMouseOver=!1})},e.prototype.hide=function(){null!==this.hideTimer&&(window.clearInterval(this.hideTimer),this.hideTimer=null),this.htmlRoot.addClass("is-hidden")},e.prototype.loadSession=function(){var e=t.Session.get("toast-message");this.setMessage({type:e.type,text:e.text,delay:e.delay}),this.show(),t.Session.clear("toast-message")},e.prototype.setMessage=function(t){this.nextMessage=t},e.prototype.show=function(){var t=this;if(null===this.nextMessage)return!1;var e=this.nextMessage;return this.nextMessage=null,this.hideTimer&&(window.clearInterval(this.hideTimer),this.hideTimer=null),null!==this.showTimer&&(window.clearTimeout(this.showTimer),this.showTimer=null),e.hasOwnProperty("delay")?this.showTimer=window.setTimeout(function(){t.showMessage(e)},1e3*e.delay):this.showMessage(e),!0},e.prototype.showMessage=function(t){var e=this;if(t.hasOwnProperty("vars"))for(var i in t.vars)t.text=t.text.split("$"+i).join(t.vars[i]);this.htmlMessage.text(t.text),this.htmlRoot.attr("class","type-"+t.type+" is-visible"),"success"===t.type&&(this.hideTimer=window.setInterval(function(){e.isMouseOver===!1&&e.hide()},3e3))},e.prototype.store=function(){null!==this.nextMessage&&(this.nextMessage.delay=.5,t.Session.set("toast-message",this.nextMessage))},e}();e.Toast=i}(e=t.Main||(t.Main={}))}(Tinycar||(Tinycar={}));var Tinycar;!function(t){var e;!function(e){var i=function(){function e(e,i){this.componentList=[],this.fieldList=[],this.App=e,this.Model=new t.Model.DataItem(i)}return e.prototype.addComponent=function(e){this.componentList.push(e),e instanceof t.Main.Field&&this.fieldList.push(e)},e.prototype.getComponentsData=function(){var t={};return this.Model.get("components").forEach(function(e){e.hasOwnProperty("data_value")&&(t[e.id]=e.data_value)}),this.fieldList.forEach(function(e){t[e.getId()]=e.getDataValue()}),t},e.prototype.getDialogName=function(){return null},e.prototype.getName=function(){return this.Model.get("name")},e.prototype.getViewName=function(){return null},e.prototype.refreshComponents=function(){this.componentList.forEach(function(t){t.isVisible()&&t.refresh()})},e.prototype.onComponent=function(t,e,i,n){},e.prototype.onResponse=function(e){e.hasString("toast")&&t.System.Toast.setMessage({type:"success",text:e.get("toast"),vars:{value:e.get("value")}}),e.isObject("link")&&e.hasString("toast")?(t.System.Toast.store(),t.Url.updatePath(e.getObject("link"),{url:t.Url.getParams()})):e.isObject("link")?t.Url.updatePath(e.getObject("link"),{url:t.Url.getParams()}):e.hasString("toast")&&t.System.Toast.show()},e}();e.View=i}(e=t.Main||(t.Main={}))}(Tinycar||(Tinycar={}));var Tinycar;!function(t){var e;!function(e){var i=function(){function e(e){this.appName=e,this.Model=new t.Model.DataItem({})}return e.prototype.build=function(){return this.buildRoot(),this.htmlRoot},e.prototype.closeDialog=function(){this.Dialog=null,this.View.refreshComponents()},e.prototype.getId=function(){return this.Model.get("id")},e.prototype.loadView=function(e){var i=this;t.Api.call({service:"application.view",params:{app:this.appName,view:e,url:t.Url.getParams()},success:function(e){t.Locale.loadText(e.text),i.Model=new t.Model.DataItem(e.app),i.View=new t.Ui.View(i,e.view),i.htmlRoot.append(i.View.build()),t.System.Page.setLayoutName(i.Model.get("layout_name")),"main"===i.Model.get("layout_name")&&t.System.Side.update(i),t.System.Page.setThemeColors(i.Model.get("colors")),window.setTimeout(function(){t.System.Page.setState("rendered"),t.Url.hasParam("id")||i.View.focus()},100)}})},e.prototype.buildRoot=function(){this.htmlRoot=$("<div>").attr("class","tinycar-ui-application")},e.prototype.openDialog=function(e){t.System.Mask.show();var i=this.getId();return e.indexOf(":")>-1&&(i=e.split(":").shift(),e=e.split(":").pop()),this.Dialog=new t.Ui.Dialog(this,{app:i,name:e}),this.htmlRoot.append(this.Dialog.build()),this.Dialog.load(this.View.getComponentsData()),this.Dialog},e}();e.Application=i}(e=t.Ui||(t.Ui={}))}(Tinycar||(Tinycar={}));var Tinycar;!function(t){var e;!function(e){var i=function(){function e(e){this.handlerList={},this.isEnabled=!0,this.Model=new t.Model.DataItem(e)}return e.prototype.build=function(){return this.buildRoot(),this.Model.hasString("icon")&&this.buildIcon(),this.Model.hasString("label")&&this.buildLabel(),this.htmlRoot},e.prototype.callHandler=function(t){this.handlerList.hasOwnProperty(t)&&this.handlerList[t]()},e.prototype.buildIcon=function(){var t=$("<span>").attr("class","icon icon-"+this.Model.get("icon")).appendTo(this.htmlRoot);t.addClass(this.Model.has("size")?"icon-"+this.Model.get("size"):"icon-small"),"theme-icon"===this.Model.get("style")&&t.addClass("icon-lite")},e.prototype.buildLabel=function(){this.htmlRoot.text(this.Model.get("label")),this.htmlRoot.addClass(this.Model.has("size")?"button-"+this.Model.get("size"):"button-default")},e.prototype.buildRoot=function(){var t=this;this.htmlRoot=$("<a>").addClass("tinycar-ui-button").addClass(this.Model.get("style")),"theme-icon"===this.Model.get("style")?this.htmlRoot.addClass("theme-base-lite"):"theme-button"===this.Model.get("style")&&this.htmlRoot.addClass("theme-base-lite"),this.htmlRoot.click(function(e){e.preventDefault(),window.setTimeout(function(){t.isEnabled===!0&&t.callHandler("click")},100)})},e.prototype.setAsEnabled=function(t){t===!0?(this.isEnabled=!0,this.htmlRoot.removeClass("is-disabled")):(this.isEnabled=!1,this.htmlRoot.addClass("is-disabled"))},e.prototype.setHandler=function(t,e){this.handlerList[t]=e},e}();e.Button=i}(e=t.Ui||(t.Ui={}))}(Tinycar||(Tinycar={}));var Tinycar;!function(t){var e;!function(e){var i=function(e){function i(){e.apply(this,arguments),this.componentData={},this.contentPadding=0,this.handlerList={}}return __extends(i,e),i.prototype.addDataForComponentType=function(t,e){this.componentData[t]=e},i.prototype.build=function(){return this.buildRoot(),this.htmlRoot},i.prototype.buildActions=function(){var e=this,i=$("<div>").attr("class","actions").appendTo(this.htmlContent);this.Model.get("actions").forEach(function(n,o){var a=new t.Ui.Button({style:0===o?"theme-button":"secondary-button",label:n.label});a.setHandler("click",function(){"cancel"===n.type?e.close():"select"===n.type?e.onSelect():e.onAction(n)}),i.append(a.build())})},i.prototype.buildClose=function(){var t=this,e=$("<a>").attr("class","close theme-base-lite").appendTo(this.htmlRoot);$("<span>").attr("class","icon icon-lite icon-medium icon-close").appendTo(e),e.click(function(e){e.preventDefault(),window.setTimeout(function(){t.close()},300)})},i.prototype.buildComponents=function(){var e=this;this.htmlComponents=$("<div>").attr("class","components").appendTo(this.htmlContent),this.Model.get("components").forEach(function(i){var n=new t.Model.DataItem(i),o=n.get("type_name");e.componentData.hasOwnProperty(o)&&n.addAll(e.componentData[o]);var a=new t.Ui.Component[o](e.App,e,n);e.htmlComponents.append(a.build()),e.addComponent(a)})},i.prototype.buildContent=function(){this.htmlContent=$("<div>").attr("class","content").appendTo(this.htmlRoot)},i.prototype.buildHeading=function(){this.htmlHeading=$("<div>").attr("class","heading").text(this.Model.get("heading")).appendTo(this.htmlContent)},i.prototype.buildRoot=function(){this.htmlRoot=$("<div>").attr("id","tinycar-ui-dialog")},i.prototype.close=function(){t.System.Mask.hide(),this.App.closeDialog(),t.System.clearEvent("resize",this.resizeEvent),this.htmlRoot.remove()},i.prototype.load=function(e){var i=this;t.Api.call({service:"dialog.view",params:{app:this.Model.get("app"),dialog:this.Model.get("name"),url:t.Url.getParams(),data:e},success:function(e){i.Model.addAll(e),i.buildClose(),i.buildContent(),i.buildHeading(),i.buildComponents(),i.buildActions(),i.resizeEvent=t.System.addEvent("resize",function(){i.updateDimensions()}),window.setTimeout(function(){i.show()},100)}})},i.prototype.onAction=function(e){var i=this,n=new t.Model.DataItem(e);t.Api.call({service:"dialog.action",params:{url:t.Url.getParams(),app:this.Model.get("app"),dialog:this.Model.get("name"),action:n.get("type"),data:this.getComponentsData()},success:function(t){n.set("value",t),i.onResponse(n),i.close()}})},i.prototype.onComponent=function(e,i,n,o){t.Api.call({service:"dialog.component",params:{app:this.Model.get("app"),dialog:this.Model.get("name"),component:e,action:i,data:n},success:o})},i.prototype.onSelect=function(){var t=[];this.componentList.forEach(function(e){"getSelectedItems"in e&&(t=t.concat(e.getSelectedItems()))}),this.handlerList.hasOwnProperty("select")&&this.handlerList.select(t),this.close()},i.prototype.setHandler=function(t,e){this.handlerList[t]=e},i.prototype.show=function(){this.contentPadding=parseInt(this.htmlContent.css("padding-top"))+parseInt(this.htmlContent.css("padding-bottom"))+10,this.htmlRoot.addClass("is-visible"),this.updateDimensions()},i.prototype.updateDimensions=function(){var t=$(window).height(),e=Math.min(t,Math.max(this.htmlComponents.outerHeight()+this.contentPadding,this.htmlComponents.get(0).scrollTop+this.htmlComponents.get(0).scrollHeight+this.contentPadding)),i=Math.max(0,Math.round((t-e)/2));this.htmlRoot.css({top:i,height:e})},i}(t.Main.View);e.Dialog=i}(e=t.Ui||(t.Ui={}))}(Tinycar||(Tinycar={}));var Tinycar;!function(t){var e;!function(e){var i=function(e){function i(){e.apply(this,arguments),this.tabFields={}}return __extends(i,e),i.prototype.build=function(){return this.buildRoot(),this.buildHeading(),this.buildTabs(),this.buildComponents(),"main"===this.App.Model.get("layout_name")?this.buildSidebar():this.buildActions(),this.updatePageTitle(),this.showTab(this.Tabs.getFirstTab()),this.htmlRoot},i.prototype.buildAction=function(e){var i=this,n=new t.Ui.Button({style:"theme-button",label:e.get("label")});return n.setHandler("click",function(){i.callAction(e)}),"submit"===e.get("type")&&t.System.addEvent("submit",function(){n.callHandler("click")}),n.build()},i.prototype.buildActions=function(){var e=this,i=$("<div>").attr("class","actions").appendTo(this.htmlRoot);this.Model.get("actions").forEach(function(n){"view"===n.target&&i.append(e.buildAction(new t.Model.DataItem(n)))})},i.prototype.buildComponents=function(){this.htmlComponents=$("<div>").attr("class","components").appendTo(this.htmlRoot)},i.prototype.buildComponentsForTab=function(e){var i=this;this.tabFields[e]=[],this.Model.get("components").forEach(function(n){var o=new t.Model.DataItem(n);if(o.get("tab_name")===e){var a=o.get("type_name"),s=new t.Ui.Component[a](i.App,i,o);i.htmlComponents.append(s.build()),i.addComponent(s),s instanceof t.Main.Field&&i.tabFields[e].push(i.fieldList.length-1)}})},i.prototype.buildHeading=function(){var e=new t.View.Heading(this.Model);this.htmlRoot.append(e.build())},i.prototype.buildRoot=function(){this.htmlRoot=$("<form>").attr("method","POST").addClass("tinycar-ui-view").addClass("layout-"+this.Model.get("layout_type")),this.htmlRoot.submit(function(e){e.preventDefault(),t.System.callEvent("submit",e)}),$("<button>").attr("type","submit").attr("class","view-submit").appendTo(this.htmlRoot)},i.prototype.buildSidebar=function(){var e=this;this.Model.get("actions").forEach(function(i){var n=new t.Ui.Sidebar.Action(e,i);t.System.Side.addAction(n)})},i.prototype.buildTabs=function(){var e=this,i=this.Model.get("tabs");this.Tabs=new t.View.Tabs(this),i.length>1&&(i.forEach(function(t){e.Tabs.addItem({name:t.name,label:t.label})}),this.htmlRoot.append(this.Tabs.build()))},i.prototype.callAction=function(e){var i=this;t.Api.call({service:"application.action",params:{url:t.Url.getParams(),app:this.App.getId(),view:this.getName(),action:e.get("type"),data:this.getComponentsData()},success:function(){i.onResponse(e)}})},i.prototype.focus=function(){var t=this.Tabs.getActiveTab();if(!this.tabFields.hasOwnProperty(t))return!1;if(0===this.tabFields[t].length)return!1;var e=this.tabFields[t][0];return this.fieldList[e].focus(),!0},i.prototype.isDefaultView=function(){return"default"===this.getName()},i.prototype.onComponent=function(e,i,n,o){t.Api.call({service:"application.component",params:{url:t.Url.getParams(),app:this.App.Model.get("id"),view:this.getName(),component:e,action:i,data:n},success:o})},i.prototype.openDialog=function(t){this.App.openDialog(t)},i.prototype.saveModel=function(e){t.Api.call({service:"application.save",params:{app:this.App.getId(),view:this.getName(),url:t.Url.getParams(),data:this.getComponentsData()},success:function(i){t.System.Toast.setMessage({type:"success",text:t.Locale.getText("toast_saved_success")}),"number"==typeof i?(t.System.Toast.store(),t.Url.updateUrl(e.getLinkUrl({id:i}))):t.System.Toast.show()}})},i.prototype.showTab=function(t){this.Tabs.setActiveTab(t),this.tabFields.hasOwnProperty(t)?this.componentList.forEach(function(e){e.setAsVisible(e.getTabName()===t)}):(this.buildComponentsForTab(t),this.componentList.forEach(function(e){e.setAsVisible(e.getTabName()===t),e.isVisible()&&e.start()}))},i.prototype.updatePageTitle=function(){var e=[];this.isDefaultView()||e.push(this.Model.get("heading")),e.push(this.App.Model.get("name")),e.push(t.Config.get("SYSTEM_TITLE")),t.System.Page.setTitle(e)},i}(t.Main.View);e.View=i}(e=t.Ui||(t.Ui={}))}(Tinycar||(Tinycar={}));var Tinycar;!function(t){var e;!function(e){var i;!function(e){var i=function(e){function i(){e.apply(this,arguments)}return __extends(i,e),i.prototype.buildButton=function(){var e=this,i=new t.Ui.Button(this.getButtonProperties());i.setHandler("click",function(){e.execute()}),this.htmlContent.append(i.build())},i.prototype.buildContent=function(){e.prototype.buildContent.call(this),this.buildButton()},i.prototype.execute=function(){var e=this;this.Model.hasString("button_dialog")?this.App.openDialog(this.Model.get("button_dialog")):this.action("click",this.View.getComponentsData(),function(i){e.View.onResponse(new t.Model.DataItem({value:i,toast:e.Model.get("button_toast")})),e.View.refreshComponents()})},i.prototype.getButtonProperties=function(){
var t={};return this.Model.hasString("button_icon")?t={style:"theme-icon",size:"tiny",icon:this.Model.get("button_icon")}:this.Model.hasString("button_label")&&(t={style:"theme-button",size:"small",label:this.Model.get("button_label")},this.Model.hasString("button_dialog")&&(t.label+="...")),t},i}(t.Main.Field);e.Button=i}(i=e.Component||(e.Component={}))}(e=t.Ui||(t.Ui={}))}(Tinycar||(Tinycar={}));var Tinycar;!function(t){var e;!function(e){var i;!function(e){var i=function(e){function i(){e.apply(this,arguments)}return __extends(i,e),i.prototype.buildContent=function(){e.prototype.buildContent.call(this),this.buildField(),this.buildInput(),this.buildLabel(),this.Model.hasString("type_help")&&this.buildHelp()},i.prototype.buildField=function(){this.htmlField=$("<div>").attr("class","field").appendTo(this.htmlContent)},i.prototype.buildHelp=function(){var e=new t.Ui.Main.Help(this.Model.get("type_help"));this.htmlField.append(e.build())},i.prototype.buildInput=function(){var t=this;this.fldInput=$("<input>").attr("id",this.getFieldId()).attr("type","checkbox").appendTo(this.htmlField),this.getDataValue()===!0&&this.fldInput.prop("checked",!0),this.fldInput.change(function(e){t.setDataValue(t.fldInput.prop("checked"))})},i.prototype.buildLabel=function(){var t=$("<label>").attr("for",this.getFieldId()).appendTo(this.htmlField),e=$("<span>").attr("class","mark").appendTo(t);$("<span>").attr("class","icon icon-lite icon-tiny icon-check").appendTo(e),$("<span>").attr("class","label").text(this.Model.get("label")).appendTo(t)},i.prototype.focus=function(){this.fldInput.focus()},i}(t.Main.Field);e.CheckBox=i}(i=e.Component||(e.Component={}))}(e=t.Ui||(t.Ui={}))}(Tinycar||(Tinycar={}));var Tinycar;!function(t){var e;!function(e){var i;!function(e){var i=function(e){function i(){e.apply(this,arguments)}return __extends(i,e),i.prototype.buildContent=function(){e.prototype.buildContent.call(this),this.Model.hasString("heading")&&this.buildHeading(),this.buildList(),this.buildInput(),this.buildButton(),this.loadList()},i.prototype.buildButton=function(){var e=this,i=new t.Ui.Button({style:"theme-button",size:"small",label:this.Model.getString("insert_button")});i.setHandler("click",function(){e.action("insert",{message:e.Input.getDataValue()},function(){e.View.onResponse(new t.Model.DataItem({toast:e.Model.get("insert_toast")})),e.Input.setDataValue(null),e.refresh()})}),this.htmlRoot.append(i.build()),this.Button=i},i.prototype.buildHeading=function(){var t=$("<div>").attr("class","heading").text(this.Model.get("heading")).appendTo(this.htmlRoot);this.htmlAmount=$("<span>").attr("class","amount").text("0").appendTo(t)},i.prototype.buildInput=function(){var e=this,i=new t.Model.DataItem({type_name:"TextInput",type_label:this.Model.getString("insert_label"),placeholder:this.Model.getString("insert_placeholder"),rows:5}),n=new t.Ui.Component.TextInput(this.App,this.View,i);n.setHandler("value",function(t){e.Button.setAsEnabled(t)}),this.htmlRoot.append(n.build()),n.setAsVisible(!0),this.Input=n},i.prototype.buildList=function(){this.htmlList=$("<div>").attr("class","list").appendTo(this.htmlRoot)},i.prototype.buildListItem=function(e){var i=$("<div>").attr("class","item"),n=t.Locale.getText("commentslist_author_wrote_at",{author:e.author,time:t.Locale.toDate(e.created,"datetime")}),o=$("<div>").attr("class","line").text(n).appendTo(i);return $("<span>").attr("class","icon icon-tiny icon-talk").prependTo(o),$("<div>").attr("class","message").html(e.message).appendTo(i),i},i.prototype.loadList=function(){var t=this;this.action("data",{},function(e){t.htmlList.empty(),t.htmlAmount.text("("+e.length+")"),e.forEach(function(e){t.htmlList.append(t.buildListItem(e))})})},i.prototype.refresh=function(){this.loadList()},i.prototype.start=function(){e.prototype.start.call(this),this.Input.start()},i}(t.Main.Component);e.CommentsList=i}(i=e.Component||(e.Component={}))}(e=t.Ui||(t.Ui={}))}(Tinycar||(Tinycar={}));var Tinycar;!function(t){var e;!function(e){var i;!function(e){var i=function(e){function i(){e.apply(this,arguments),this.dataList=[],this.htmlListColumns=[],this.htmlListItems={},this.isSearchVisible=!1,this.isSelectable=!1,this.lastQuery="",this.selectedItems=[],this.selectedLimit=0,this.viewList=[],this.settingsData={order:0,sort:"asc",query:""}}return __extends(i,e),i.prototype.buildMenuAction=function(){var t=this,e=$("<a>").attr("class","search").appendTo(this.htmlListTable);$("<span>").attr("class","icon icon-small icon-menu-vertical").appendTo(e),e.click(function(e){e.preventDefault(),window.setTimeout(function(e){t.showSearch(!t.isSearchVisible,!0)},200)})},i.prototype.buildContent=function(){this.buildListTable(),this.buildMenuAction(),this.buildListColumns(),this.buildListData(),this.htmlRoot.addClass("search-hidden"),this.Model.isObject("link")?this.linkPattern=t.Url.getAsPath(this.Model.get("link")):(this.isSelectable=!0,this.htmlRoot.addClass("is-selectable"),this.selectedLimit=this.Model.getNumber("data_limit"),this.selectedItems=this.Model.getList("data_value")),this.loadSettings(),this.setColumnOrder(this.settingsData.order),this.settingsData.query.length>0&&this.showSearch(!0,!1),this.loadList()},i.prototype.buildListColumn=function(t,e){var i=this,n=$("<div>").attr("class","column"),o=$("<a>").text(e.label).appendTo(n);return o.click(function(e){e.preventDefault(),i.setColumnSort(t),i.setColumnOrder(t),i.storeSettings(),i.updateListOrder(),i.buildListItems()}),$("<span>").attr("class","icon icon-small icon-sort-down").appendTo(o),$("<span>").attr("class","icon icon-small icon-sort-up").appendTo(o),e.width>0&&n.css("width",e.width),this.htmlListColumns.push(n),n},i.prototype.buildListColumns=function(){var t=this,e=$("<div>").attr("class","columns").appendTo(this.htmlListTable);this.Model.get("columns").forEach(function(i,n){e.append(t.buildListColumn(n,i))})},i.prototype.buildListData=function(){this.htmlListData=$("<div>").attr("class","list").appendTo(this.htmlListTable)},i.prototype.buildListItem=function(e){var i=this,n=this.dataList[e],o=n.id.value,a=$("<a>").attr("class","item").appendTo(this.htmlListData);"string"==typeof this.linkPattern?a.attr("href",this.linkPattern.split("$model.id").join(o)):this.isSelectable===!0&&this.selectedItems.indexOf(o)>-1&&a.addClass("is-selected"),a.click(function(e){e.preventDefault(),i.isSelectable===!0?i.selectListItem(o):t.Url.openUrl(a.attr("href"))}),this.Model.get("columns").forEach(function(t,e){a.append(i.buildListItemColumn(e,t,n))}),this.htmlListItems[o]=a},i.prototype.buildListItemColumn=function(t,e,i){var n=$("<span>").text(i[e.name].text).attr("class","column");if(0===t){var o=$("<span>").attr("class","check").appendTo(n);$("<span>").attr("class","icon icon-tiny icon-lite icon-check").appendTo(o)}return n},i.prototype.buildListItems=function(){var t=this;this.htmlListItems={},this.htmlListData.empty(),this.dataList.forEach(function(e,i){t.viewList.indexOf(i)>-1&&t.buildListItem(i)})},i.prototype.buildListTable=function(){this.htmlListTable=$("<div>").attr("class","table").appendTo(this.htmlRoot)},i.prototype.buildSearchField=function(){var e=this,i=null,n=$("<div>").attr("class","search").insertBefore(this.htmlListData),o=$("<div>").attr("class","content theme-base").appendTo(n),a=$("<input>").attr("type","text").attr("placeholder",t.Locale.getText("datagrid_type_search")).prop("value",this.settingsData.query).appendTo(o),s=$("<a>").attr("class","reset").attr("title",t.Locale.getText("datagrid_reset_search")).click(function(t){t.preventDefault(),e.showSearch(!1,!1)}).appendTo(o);$("<span>").attr("class","icon icon-small icon-close").appendTo(s),a.change(function(t){e.filterDataItems(a.val())}),a.keydown(function(t){i&&window.clearTimeout(i),t.ctrlKey||27!==t.keyCode?i=window.setTimeout(function(){i=null,a.trigger("change")},250):(t.preventDefault(),e.showSearch(!1,!1))}),this.fldSearch=a},i.prototype.filterDataItems=function(t){if(this.lastQuery!==t){if(this.settingsData.query=t,this.storeSettings(),this.lastQuery=t,t=jQuery.trim(t.toLowerCase()),0===t.length)this.resetViewList();else{var e=[];this.dataList.forEach(function(i,n){for(var o in i)if(i[o].text.toLowerCase().indexOf(t)>-1){e.push(n);break}}),this.viewList=e}this.buildListItems()}},i.prototype.getSelectedItems=function(){return this.selectedItems},i.prototype.loadList=function(){var t=this;this.action("data",{},function(e){t.dataList=e,t.resetViewList(),t.updateListOrder(),t.settingsData.query.length>0&&t.filterDataItems(t.settingsData.query),t.buildListItems(),$(window).trigger("resize")})},i.prototype.loadSettings=function(){this.settingsId="datagrid-"+t.Url.getUid()+"-"+this.getId();var e=t.Session.get(this.settingsId);e.hasOwnProperty("order")&&(this.settingsData.order=e.order),e.hasOwnProperty("sort")&&(this.settingsData.sort=e.sort),e.hasOwnProperty("query")&&(this.settingsData.query=e.query)},i.prototype.refresh=function(){this.loadList()},i.prototype.resetViewList=function(){var t=[];this.dataList.forEach(function(e,i){t.push(i)}),this.viewList=t},i.prototype.selectListItem=function(t){var e=this.selectedItems.indexOf(t);e>-1?(this.selectedItems.splice(e,1),"undefined"!=typeof this.htmlListItems[t]&&this.htmlListItems[t].removeClass("is-selected")):(this.selectedItems.push(t),"undefined"!=typeof this.htmlListItems[t]&&this.htmlListItems[t].addClass("is-selected"),this.selectedLimit>0&&this.selectedItems.length>this.selectedLimit&&this.selectListItem(this.selectedItems[0]))},i.prototype.setColumnOrder=function(t){if(this.settingsData.order!==t){var e=this.settingsData.order;this.htmlListColumns[e].attr("class","column")}var i=this.settingsData.sort;this.htmlListColumns[t].attr("class","column sort-"+i),this.settingsData.order=t},i.prototype.setColumnSort=function(t){var e="asc";this.settingsData.order===t&&(e="asc"===this.settingsData.sort?"desc":"asc"),this.settingsData.sort=e},i.prototype.setSelectedItems=function(t){},i.prototype.showSearch=function(t,e){t===!0?(this.fldSearch instanceof Object||this.buildSearchField(),this.htmlRoot.removeClass("search-hidden").addClass("search-visible"),e===!0&&this.fldSearch.focus()):(this.fldSearch.val(""),this.filterDataItems(""),this.htmlRoot.removeClass("search-visible").addClass("search-hidden")),this.isSearchVisible=t},i.prototype.storeSettings=function(){t.Session.set(this.settingsId,this.settingsData)},i.prototype.updateListOrder=function(){var t=this.Model.getIndex("columns",this.settingsData.order),e=t.name,i=(t.type,"asc"===this.settingsData.sort?-1:1),n="asc"===this.settingsData.sort?1:-1;this.dataList.sort(function(t,o){var a=t[e].value,s=o[e].value;return s>a?i:a>s?n:0})},i}(t.Main.Component);e.DataGrid=i}(i=e.Component||(e.Component={}))}(e=t.Ui||(t.Ui={}))}(Tinycar||(Tinycar={}));var Tinycar;!function(t){var e;!function(e){var i;!function(e){var i=function(e){function i(){e.apply(this,arguments),this.hasPicker=!1}return __extends(i,e),i.prototype.buildContent=function(){e.prototype.buildContent.call(this),this.buildField(),this.buildButton(),this.buildLine()},i.prototype.buildDatePicker=function(){var e=this;t.System.Page.loadVendor("jqueryui",function(){e.fldInput=$(e.fldInput),e.fldInput.datepicker(e.getDatePickerConfig()),e.fldInput.datepicker("show"),e.fldInput.blur(),e.hasPicker=!0})},i.prototype.buildButton=function(){var e=this,i=new t.Ui.Button({style:"dark-icon",icon:"date"});i.setHandler("click",function(){e.hasPicker===!1?e.buildDatePicker():(e.fldInput.datepicker("show"),e.fldInput.blur())}),this.htmlField.append(i.build())},i.prototype.buildField=function(){var e=this;this.htmlField=$("<div>").attr("class","field").appendTo(this.htmlContent),this.fldInput=$("<input>").attr("type","text").attr("placeholder",this.Model.get("placeholder")).keyup(function(t){e.updateValueFromInput()}).change(function(t){e.updateValueFromInput()}).appendTo(this.htmlField),this.hasDateTimeFormat()===!0&&this.htmlField.addClass("has-datetime"),this.getDataValue()>0&&(this.lastValue=t.Format.toDate(this.getDataValue(),this.Model.get("data_format")),this.fldInput.prop("value",this.lastValue))},i.prototype.buildLine=function(){$("<span>").attr("class","line").appendTo(this.htmlContent)},i.prototype.focus=function(){this.fldInput.focus()},i.prototype.getDatePickerConfig=function(){var e=this,i=this.Model.get("data_format");i=this.getDatePickerFormat(i);for(var n={showOn:"button",constrainInput:!1,dateFormat:i,dayNames:[],dayNamesMin:[],firstDay:t.Locale.getCalendar("first_weekday"),monthNames:[],nextText:t.Locale.getText("calendar_next_month"),prevText:t.Locale.getText("calendar_prev_month"),showWeek:t.Locale.getCalendar("show_weeks"),weekHeader:"",beforeShow:function(t,i){var n=e.getDataValue();if(n>0){var o=e.fldInput.val();e.fldInput.datepicker("setDate",new Date(1e3*o)),e.fldInput.val(o)}},onSelect:function(t,i){e.updateValueFromInput()},onClose:function(t,i){e.updateValueFromInput()}},o=0;6>=o;++o){var a=t.Locale.getText("calendar_day_"+o);n.dayNames.push(a),n.dayNamesMin.push(a.substring(0,1))}for(var s=1;12>=s;++s)n.monthNames.push(t.Locale.getText("calendar_month_"+s));return n},i.prototype.getDatePickerFormat=function(t){return t=t.replace("d","dd"),t=t.replace("m","mm"),t=t.replace("j","d"),t=t.replace("n","m"),t=t.replace("Y","yy"),t=t.replace("H","00"),t=t.replace("i","00")},i.prototype.updateValueFromInput=function(){var e=this.fldInput.val();if(this.lastValue===e)return!1;var i=t.Format.toTime(e);return null===i?!1:(this.lastValue=e,this.setDataValue(i),!0)},i.prototype.getDataValue=function(){return this.Model.getNumber("data_value")},i.prototype.hasDateTimeFormat=function(){return this.Model.get("data_format").indexOf("H")>5},i.prototype.setDataValue=function(t){this.Model.set("data_value",t)},i}(t.Main.Field);e.DateTime=i}(i=e.Component||(e.Component={}))}(e=t.Ui||(t.Ui={}))}(Tinycar||(Tinycar={}));var Tinycar;!function(t){var e;!function(e){var i;!function(e){var i=function(e){function i(){e.apply(this,arguments)}return __extends(i,e),i.prototype.buildContent=function(){e.prototype.buildContent.call(this),this.isTable()?this.buildTable():this.buildList()},i.prototype.buildComponent=function(e){var i=new t.Model.DataItem(e),n=i.get("type_name");i.set("tab_name",this.Model.get("tab_name"));var o=new t.Ui.Component[n](this.App,this.View,i),a=o.build();return this.View.addComponent(o),a},i.prototype.buildList=function(){var t=this;this.Model.get("components").forEach(function(e){t.htmlContent.append(t.buildComponent(e))})},i.prototype.buildTable=function(){var t=this,e=this.Model.getNumber("columns"),i=this.Model.getList("components"),n=$("<div>").attr("class","row").appendTo(this.htmlContent);i.forEach(function(i,o){o%e===0&&(n=$("<div>").attr("class","row").appendTo(t.htmlContent)),n.append(t.buildComponent(i))});for(var o=i.length;o%e!==0;++o){var a=$("<div>").addClass("tinycar-main-component").addClass("tinycar-main-field").appendTo(n);$("<div>").attr("class","type-label").appendTo(a)}},i.prototype.getRootStyles=function(){var t=e.prototype.getRootStyles.call(this);return t.push("layout-"+this.Model.get("layout")),t.push("columns-"+this.Model.get("columns")),t},i.prototype.isTable=function(){return"table"===this.Model.get("layout")&&this.Model.getNumber("columns")>1},i}(t.Main.Field);e.Group=i}(i=e.Component||(e.Component={}))}(e=t.Ui||(t.Ui={}))}(Tinycar||(Tinycar={}));var Tinycar;!function(t){var e;!function(e){var i;!function(e){var i=t.Main,n=t.Ui,o=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.buildContent=function(){this.buildList(),this.buildItems()},e.prototype.buildItems=function(){var t=this;this.action("data",{},function(e){e.forEach(function(e){var i=new n.Main.Icon({path:{app:e.id,view:"default"},label:e.name,color:e.color,icon:e.icon});t.htmlList.append(i.build())})})},e.prototype.buildList=function(){this.htmlList=$("<div>").attr("class","list").appendTo(this.htmlRoot)},e}(i.Component);e.IconListView=o}(i=e.Component||(e.Component={}))}(e=t.Ui||(t.Ui={}))}(Tinycar||(Tinycar={}));var Tinycar;!function(t){var e;!function(e){var i;!function(e){var i=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.buildContent=function(){t.prototype.buildContent.call(this),this.buildInput(),this.initListeners()},e.prototype.buildInput=function(){this.fldInput=$("<input>").attr("id",this.getFieldId()).attr("type","password").attr("placeholder",this.Model.getString("placeholder")).appendTo(this.htmlContent)},e.prototype.focus=function(){this.fldInput.focus()},e.prototype.initListeners=function(){var t=this,e=null;this.fldInput.change(function(e){t.setDataValue(t.fldInput.val())}),this.fldInput.keyup(function(i){e&&window.clearTimeout(e),e=window.setTimeout(function(){t.fldInput.trigger("change")},300)})},e}(t.Main.Field);e.Password=i}(i=e.Component||(e.Component={}))}(e=t.Ui||(t.Ui={}))}(Tinycar||(Tinycar={}));var Tinycar;!function(t){var e;!function(e){var i;!function(e){var i=function(e){function i(){e.apply(this,arguments),this.fldOptions=[]}return __extends(i,e),i.prototype.buildContent=function(){e.prototype.buildContent.call(this),this.buildOptions(),this.updateOptions()},i.prototype.buildOption=function(e){var i=this,n=$("<div>").attr("class","item"),o=$("<input>").attr("id",this.getFieldId(e.name)).attr("name",this.getFieldId()).attr("type","radio").attr("value",e.name).appendTo(n);o.change(function(t){i.setDataValue(o.val())});var a=$("<label>").attr("for",this.getFieldId(e.name)).appendTo(n),s=$("<span>").attr("class","mark").appendTo(a);if($("<span>").attr("class","point").appendTo(s),$("<span>").attr("class","label").text(e.label).appendTo(a),"string"==typeof e.help){var r=new t.Ui.Main.Help(e.help);n.append(r.build())}return"string"==typeof e.instructions&&$("<div>").attr("class","instructions").text(e.instructions).appendTo(n),this.fldOptions.push(o),n},i.prototype.buildOptions=function(){var t=this;this.Model.get("options").forEach(function(e){t.htmlContent.append(t.buildOption(e))})},i.prototype.getRootStyles=function(){var t=e.prototype.getRootStyles.call(this);return t.push("layout-"+this.Model.get("layout")),t},i.prototype.updateOptions=function(){var t=""+this.getDataValue();this.fldOptions.forEach(function(e){e.prop("checked",e.val()===t)})},i}(t.Main.Field);e.RadioList=i}(i=e.Component||(e.Component={}))}(e=t.Ui||(t.Ui={}))}(Tinycar||(Tinycar={}));var Tinycar;!function(t){var e;!function(e){var i;!function(e){var i=function(e){function i(){e.apply(this,arguments),this.htmlItems={}}return __extends(i,e),i.prototype.addListItem=function(t){var e=this,i=t.id;for(var n in t);var o=$("<div>").attr("class","item").text(t[n]).appendTo(this.htmlList),a=$("<a>").attr("class","close").click(function(t){t.preventDefault(),e.clearListItem(i)}).appendTo(o);$("<span>").attr("class","icon icon-tiny icon-close").appendTo(a),this.htmlItems[i]=o},i.prototype.buildButton=function(){var e=this,i=new t.Ui.Button({style:"theme-icon",icon:"menu-horizontal",size:"tiny"});i.setHandler("click",function(){var t=e.App.openDialog(e.Model.get("data_dialog"));t.addDataForComponentType("DataGrid",{data_value:e.Model.getList("data_value"),data_limit:e.Model.getNumber("data_limit")}),t.setHandler("values",function(){return e.getDataValue()}),t.setHandler("select",function(t){e.setDataValue(t),e.updateListItems()})}),this.htmlContent.append(i.build())},i.prototype.buildContent=function(){e.prototype.buildContent.call(this),this.buildListItems(),this.buildButton()},i.prototype.buildListItems=function(){var t=this;this.htmlList=$("<div>").attr("class","list").appendTo(this.htmlContent),this.Model.get("type_items").forEach(function(e){t.addListItem(e)})},i.prototype.clearListItem=function(t){"undefined"!=typeof this.htmlItems[t]&&(this.htmlItems[t].remove(),delete this.htmlItems[t])},i.prototype.getDataValue=function(){return this.Model.getList("data_value")},i.prototype.setDataValue=function(t){this.Model.set("data_value",t)},i.prototype.updateListItems=function(){var t=this;this.action("data",{value:this.getDataValue()},function(e){t.htmlItems={},t.htmlList.empty(),e.forEach(function(e){t.addListItem(e)})})},i}(t.Main.Field);e.Reference=i}(i=e.Component||(e.Component={}))}(e=t.Ui||(t.Ui={}))}(Tinycar||(Tinycar={}));var Tinycar;!function(t){var e;!function(e){var i;!function(e){var i=function(e){function i(){e.apply(this,arguments)}return __extends(i,e),i.prototype.buildContent=function(){var i=this;e.prototype.buildContent.call(this),this.buildEditor(),t.System.Page.loadVendor("trumbowyg",function(){i.initEditor()})},i.prototype.buildEditor=function(){this.htmlEditor=$("<textarea>").attr("class","editor").attr("placeholder",this.Model.get("placeholder")).prop("spellcheck",!1).prop("value",this.getDataValue()).appendTo(this.htmlContent)},i.prototype.initEditor=function(){var t=this;this.htmlEditor.trumbowyg({removeformatPasted:!0}),$("div.trumbowyg-editor:first").prop("spellcheck",!1),this.htmlEditor.on("tbwchange",function(){t.setDataValue(t.htmlEditor.trumbowyg("html"))})},i.prototype.focus=function(){this.htmlEditor.focus()},i}(t.Main.Field);e.RichText=i}(i=e.Component||(e.Component={}))}(e=t.Ui||(t.Ui={}))}(Tinycar||(Tinycar={}));var Tinycar;!function(t){var e;!function(e){var i;!function(e){var i=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.buildContent=function(){t.prototype.buildContent.call(this),this.buildList()},e.prototype.buildList=function(){var t=this,e=$("<div>").attr("class","list").appendTo(this.htmlContent);$("<span>").attr("class","icon icon-small icon-sort-down").appendTo(e),this.fldList=$("<select>").attr("size",1).appendTo(e);var i=this.Model.get("options");i.forEach(function(e){$("<option>").attr("value",e.name).text(e.label).appendTo(t.fldList)}),this.fldList.change(function(e){t.setDataValue(t.fldList.val())}),null===this.Model.get("data_value")&&i.length>0&&this.Model.set("data_value",i[0].name),null!==this.Model.get("data_value")&&this.fldList.val(this.Model.get("data_value"))},e.prototype.focus=function(){this.fldList.focus()},e}(t.Main.Field);e.SelectList=i}(i=e.Component||(e.Component={}))}(e=t.Ui||(t.Ui={}))}(Tinycar||(Tinycar={}));var Tinycar;!function(t){var e;!function(e){var i;!function(e){var i=function(e){function i(){e.apply(this,arguments),this.htmlItems={}}return __extends(i,e),i.prototype.addItemFromField=function(){var t=jQuery.trim(this.fldInput.val());if(!this.buildListItem(t))return!1;var e=this.getDataValue();return e.push(t),this.setDataValue(e),this.fldInput.val("").focus(),!0},i.prototype.buildContent=function(){var t=this;e.prototype.buildContent.call(this),this.buildList(),this.buildInput(),this.getDataValue().forEach(function(e){t.buildListItem(e)})},i.prototype.buildField=function(){this.htmlField=$("<div>").attr("class","field").appendTo(this.htmlContent)},i.prototype.buildList=function(){this.htmlList=$("<div>").attr("class","list").appendTo(this.htmlContent)},i.prototype.buildListItem=function(t){var e=this;if(0===t.length)return!1;var i=t.toLowerCase();this.htmlItems.hasOwnProperty(i)&&this.clearListItem(i);var n=$("<div>").attr("class","item").text(t).insertBefore(this.htmlField),o=$("<a>").attr("class","close").mousedown(function(t){t.preventDefault()}).click(function(t){t.preventDefault(),e.clearListItem(i)}).appendTo(n);return $("<span>").attr("class","icon icon-tiny icon-close").appendTo(o),this.htmlItems[i]=n,!0},i.prototype.buildInput=function(){var e=this;this.htmlField=$("<div>").attr("class","field").appendTo(this.htmlList),this.fldInput=$("<input>").attr("type","text").attr("placeholder",this.Model.getString("placeholder")).keydown(function(t){13===t.keyCode&&(t.preventDefault(),e.addItemFromField())}).appendTo(this.htmlField);var i=new t.Ui.Button({style:"dark-icon",icon:"add"});i.setHandler("click",function(){e.addItemFromField()}),this.htmlField.append(i.build())},i.prototype.clearListItem=function(t){if(!this.htmlItems.hasOwnProperty(t))return!1;var e=this.htmlItems[t].text();this.htmlItems[t].remove(),delete this.htmlItems[t];var i=this.getDataValue(),n=i.indexOf(e);return n>-1&&i.splice(n,1),this.setDataValue(i),!0},i.prototype.focus=function(){this.fldInput.focus()},i.prototype.getDataValue=function(){return this.Model.getList("data_value")},i.prototype.setDataValue=function(t){this.Model.set("data_value",t)},i}(t.Main.Field);e.TagsList=i}(i=e.Component||(e.Component={}))}(e=t.Ui||(t.Ui={}))}(Tinycar||(Tinycar={}));var Tinycar;!function(t){var e;!function(e){var i;!function(e){var i=function(e){function i(){e.apply(this,arguments)}return __extends(i,e),i.prototype.buildContent=function(){this.buildTable(),this.linkPattern=t.Url.getAsPath(this.Model.getObject("link")),this.loadList()},i.prototype.buildData=function(t){var e=this;t.forEach(function(t){e.buildDataItem(t)})},i.prototype.buildDataItem=function(e){var i=this.linkPattern.split("$model.id").join(e.id),n=$("<a>").attr("href",i).attr("class","item").click(function(e){e.preventDefault(),t.Url.openUrl(i)}).appendTo(this.htmlTable);$("<span>").attr("class","image").css("background-color",e.image_color).css("background-image","url("+e.image_data+")").appendTo(n),$("<span>").attr("class","label").text(e.label).appendTo(n),$("<span>").attr("class","description").text(e.description).appendTo(n),$("<span>").attr("class","status status-"+e.status_type).text(e.status_label).appendTo(n)},i.prototype.buildTable=function(){this.htmlTable=$("<div>").attr("class","table").appendTo(this.htmlRoot)},i.prototype.loadList=function(){var t=this;this.action("data",{},function(e){t.buildData(e)})},i}(t.Main.Component);e.TileGrid=i}(i=e.Component||(e.Component={}))}(e=t.Ui||(t.Ui={}))}(Tinycar||(Tinycar={}));var Tinycar;!function(t){var e;!function(e){var i;!function(e){var i=function(e){function i(){e.apply(this,arguments)}return __extends(i,e),i.prototype.buildContent=function(){e.prototype.buildContent.call(this),null===this.getDataValue()?this.buildPlaceholder():this.Model.isObject("link")?this.buildLink():this.buildText()},i.prototype.buildLink=function(){var e=t.Url.getAsPath(this.Model.getObject("link")),i=$("<a>").attr("href",e).attr("class","link").appendTo(this.htmlContent);$("<span>").attr("class","label").html(this.getDataValue()).appendTo(i),$("<span>").attr("class","icon icon-tiny icon-arrow-right").appendTo(i),i.click(function(e){t.System.Page.setState("unloading")})},i.prototype.buildPlaceholder=function(){var t=this.Model.getString("placeholder");0===t.length&&(t="&nbsp;"),$("<span>").attr("class","text placeholder").html(t).appendTo(this.htmlContent)},i.prototype.buildText=function(){$("<span>").attr("class","text").html(this.getDataValue()).appendTo(this.htmlContent)},i}(t.Main.Field);e.Text=i}(i=e.Component||(e.Component={}))}(e=t.Ui||(t.Ui={}))}(Tinycar||(Tinycar={}));var Tinycar;!function(t){var e;!function(e){var i;!function(e){var i=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.buildContent=function(){this.buildText()},e.prototype.buildText=function(){$("<div>").attr("class","text").html(this.Model.get("text")).appendTo(this.htmlRoot)},e}(t.Main.Component);e.TextContent=i}(i=e.Component||(e.Component={}))}(e=t.Ui||(t.Ui={}))}(Tinycar||(Tinycar={}));var Tinycar;!function(t){var e;!function(e){var i;!function(e){var i=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.buildContent=function(){t.prototype.buildContent.call(this),this.Model.get("rows")>0?this.buildArea():this.buildInput(),this.initListeners()},e.prototype.buildArea=function(){this.fldInput=$("<textarea>").attr("id",this.getFieldId()).attr("placeholder",this.Model.getString("placeholder")).attr("rows",this.Model.get("rows")).prop("spellcheck",!1).prop("value",this.getDataValue()).appendTo(this.htmlContent),this.Model.get("maxlength")>0&&this.fldInput.prop("maxlength",this.Model.get("maxlength"))},e.prototype.buildInput=function(){this.fldInput=$("<input>").attr("id",this.getFieldId()).attr("type","text").attr("placeholder",this.Model.getString("placeholder")).prop("spellcheck",!1).prop("value",this.getDataValue()).appendTo(this.htmlContent),this.Model.get("maxlength")>0&&this.fldInput.prop("maxlength",this.Model.get("maxlength"))},e.prototype.focus=function(){this.fldInput.focus()},e.prototype.initListeners=function(){var t=this,e=null;this.fldInput.change(function(e){var i=t.fldInput.val();t.setDataValue(i)}),this.fldInput.keyup(function(i){e&&window.clearTimeout(e),e=window.setTimeout(function(){t.fldInput.trigger("change")},300)})},e.prototype.setDataValue=function(e){t.prototype.setDataValue.call(this,e),this.fldInput.val(e);var i=this.Model.hasString("data_value");this.hasValue!==i&&(this.hasValue=i,this.callHandler("value",this.hasValue))},e.prototype.start=function(){t.prototype.start.call(this),this.hasValue=this.Model.hasString("data_value"),this.callHandler("value",this.hasValue)},e}(t.Main.Field);e.TextInput=i}(i=e.Component||(e.Component={}))}(e=t.Ui||(t.Ui={}))}(Tinycar||(Tinycar={}));var Tinycar;!function(t){var e;!function(e){var i;!function(e){var i=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.buildContent=function(){t.prototype.buildContent.call(this),this.buildToggle()},e.prototype.buildToggle=function(){var t=this,e=$("<a>").attr("href","#toggle").attr("class","toggle").appendTo(this.htmlContent);$("<span>").attr("class","icon icon-lite icon-tiny icon-check").appendTo(e);var i=$("<span>").attr("class","handle").appendTo(e);$("<span>").attr("class","icon icon-tiny icon-handle").appendTo(i),this.getDataValue()===!0&&(e.addClass("is-active"),this.isTypeEnabled()===!0&&e.addClass("theme-base-lite")),e.click(function(i){i.preventDefault(),1==t.isTypeEnabled()&&(e.toggleClass("is-active"),e.toggleClass("theme-base-lite"),t.setDataValue(!(t.getDataValue()===!0)))})},e}(t.Main.Field);e.Toggle=i}(i=e.Component||(e.Component={}))}(e=t.Ui||(t.Ui={}))}(Tinycar||(Tinycar={}));var Tinycar;!function(t){var e;!function(t){var e;!function(t){var e=function(){function t(t){this.isContentVisible=!1,this.contentText=jQuery.trim(t)}return t.prototype.build=function(){return this.buildRoot(),this.buildLink(),this.htmlRoot},t.prototype.buildContent=function(){this.htmlContent=$("<div>").attr("class","tinycar-ui-main-help-content").text(this.contentText).appendTo(document.body)},t.prototype.buildLink=function(){var t=this,e=$("<a>").attr("href","#help").attr("class","link").click(function(e){e.preventDefault(),t.toggleContent()}).appendTo(this.htmlRoot);$("<span>").attr("class","icon icon-tiny icon-help").appendTo(e)},t.prototype.buildRoot=function(){this.htmlRoot=$("<span>").attr("class","tinycar-ui-main-help")},t.prototype.hideContent=function(){this.htmlRoot.removeClass("is-open"),this.htmlContent.hide(),this.isContentVisible=!1},t.prototype.showContent=function(){var t=this;this.htmlContent instanceof Object||this.buildContent();var e=this.htmlRoot.offset();this.htmlContent.css({left:e.left,top:e.top}),this.htmlContent.show(),this.htmlRoot.addClass("is-open");var i=function(){$(window).unbind("click",i),$(window).unbind("resize",n),t.hideContent()},n=function(t){i()};window.setTimeout(function(){$(window).bind("click",i),$(window).bind("resize",n)},10),this.isContentVisible=!0},t.prototype.toggleContent=function(){this.isContentVisible===!0?this.hideContent():this.showContent()},t}();t.Help=e}(e=t.Main||(t.Main={}))}(e=t.Ui||(t.Ui={}))}(Tinycar||(Tinycar={}));var Tinycar;!function(t){var e;!function(e){var i;!function(e){var i=t.Model,n=function(){function e(t){this.Model=new i.DataItem(t)}return e.prototype.build=function(){return this.buildRoot(),this.buildIcon(),this.buildLabel(),this.htmlRoot},e.prototype.buildIcon=function(){$("<span>").attr("class","icon").css("background-color",this.Model.get("color")).css("background-image","url("+this.Model.get("icon")+")").appendTo(this.htmlRoot)},e.prototype.buildLabel=function(){$("<span>").attr("class","label").text(this.Model.get("label")).appendTo(this.htmlRoot)},e.prototype.buildRoot=function(){
var e=this;this.htmlRoot=$("<a>").attr("class","tinycar-ui-main-icon").attr("href",t.Url.getAsPath(this.Model.get("path"))),this.htmlRoot.click(function(i){i.preventDefault(),t.Url.openUrl(e.htmlRoot.attr("href"))})},e}();e.Icon=n}(i=e.Main||(e.Main={}))}(e=t.Ui||(t.Ui={}))}(Tinycar||(Tinycar={}));var Tinycar;!function(t){var e;!function(e){var i;!function(e){var i=function(){function e(e,i){this.Model=new t.Model.DataItem(i),this.View=e}return e.prototype.build=function(){return this.buildRoot(),this.buildIcon(),this.buildLabel(),this.htmlRoot},e.prototype.buildIcon=function(){$("<span>").attr("class","icon icon-lite icon-small icon-"+this.Model.get("type")).appendTo(this.htmlRoot)},e.prototype.buildLabel=function(){var t=this.Model.get("label");this.Model.hasString("dialog")&&(t+="...");var e=$("<span>").attr("class","label").appendTo(this.htmlRoot);e.text(t),$("<span>").attr("class","icon icon-small icon-"+this.Model.get("type")).appendTo(e)},e.prototype.buildRoot=function(){var e=this;this.htmlRoot=$("<a>").attr("href","#"+this.Model.get("type")).addClass("tinycar-ui-sidebar-action"),this.isLinkAction()&&this.htmlRoot.attr("href",t.Url.getAsPath(this.Model.get("link"))),this.htmlRoot.click(function(t){t.ctrlKey===!1&&(t.preventDefault(),e.execute())})},e.prototype.execute=function(){return this.Model.hasString("dialog")?(this.View.openDialog(this.Model.get("dialog")),!0):this.isSaveAction()?(this.View.saveModel(this),!0):this.isServiceAction()?(this.View.callAction(this.Model),!0):this.isLinkAction()?(t.Url.openUrl(this.htmlRoot.attr("href")),!0):!1},e.prototype.getLinkUrl=function(e){var i=t.Url.getAsPath(this.Model.getObject("link")),n=t.Url.getParams();for(var o in n)i=i.split("$url."+o).join(n[o]);for(var o in e)i=i.split("$model."+o).join(e[o]);return i},e.prototype.getToastMessage=function(){return this.Model.get("toast")},e.prototype.getType=function(){return this.Model.get("type")},e.prototype.hasLinkUrl=function(){return this.Model.isObject("link")},e.prototype.hasToastMessage=function(){return this.Model.hasString("toast")},e.prototype.isLinkAction=function(){return!this.isSaveAction()&&!this.isServiceAction()&&this.Model.isObject("link")},e.prototype.isSaveAction=function(){return"save"===this.Model.get("type")},e.prototype.isSessionAction=function(){return"session"===this.Model.get("target")},e.prototype.isServiceAction=function(){return this.Model.hasString("service")},e.prototype.isViewAction=function(){return"view"===this.Model.get("target")},e}();e.Action=i}(i=e.Sidebar||(e.Sidebar={}))}(e=t.Ui||(t.Ui={}))}(Tinycar||(Tinycar={}));var Tinycar;!function(t){var e;!function(e){var i=function(){function e(t){this.Model=t}return e.prototype.build=function(){return this.buildRoot(),this.buildHeading(),this.buildDetails(),this.htmlRoot},e.prototype.buildDetails=function(){var t=$("<div>").attr("class","details").appendTo(this.htmlRoot);this.Model.hasNumber("created_time")&&$("<span>").text(this.getDateLabel("created_time")).appendTo(t),this.Model.hasNumber("modified_time")&&$("<span>").text(this.getDateLabel("modified_time")).appendTo(t)},e.prototype.buildHeading=function(){$("<strong>").text(this.Model.get("heading")).appendTo(this.htmlRoot)},e.prototype.buildRoot=function(){this.htmlRoot=$("<div>").attr("class","tinycar-view-heading")},e.prototype.getDateLabel=function(e){var i=t.Locale.toDate(this.Model.get(e),"datetime");return t.Locale.getText("view_"+e,{time:i})},e}();e.Heading=i}(e=t.View||(t.View={}))}(Tinycar||(Tinycar={}));var Tinycar;!function(t){var e;!function(t){var e=function(){function t(t){this.htmlTabs={},this.tabList=[],this.tabNames=[],this.View=t}return t.prototype.addItem=function(t){this.tabList.push(t)},t.prototype.build=function(){var t=this;return this.buildRoot(),this.buildLine(),this.tabList.forEach(function(e){t.buildItem(e)}),this.htmlRoot},t.prototype.buildItem=function(t){var e=this,i=$("<a>").attr("class","item").text(t.label).appendTo(this.htmlRoot);i.click(function(i){i.preventDefault(),e.View.showTab(t.name)}),this.tabNames.push(t.name),this.htmlTabs[t.name]=i},t.prototype.buildLine=function(){$("<span>").attr("class","line").appendTo(this.htmlRoot)},t.prototype.buildRoot=function(){this.htmlRoot=$("<div>").attr("class","tinycar-view-tabs")},t.prototype.getFirstTab=function(){return this.tabNames.length>0?this.tabNames[0]:"default"},t.prototype.getActiveTab=function(){return this.activeTab},t.prototype.setActiveTab=function(t){"string"==typeof this.activeTab&&this.htmlTabs[this.activeTab].removeClass("is-active").removeClass("theme-border"),this.activeTab=t,this.htmlTabs.hasOwnProperty(t)&&this.htmlTabs[this.activeTab].addClass("is-active").addClass("theme-border")},t}();t.Tabs=e}(e=t.View||(t.View={}))}(Tinycar||(Tinycar={}));